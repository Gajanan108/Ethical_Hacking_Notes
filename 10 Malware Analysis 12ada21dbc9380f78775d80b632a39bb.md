# 10. Malware Analysis

Hereâ€™s a CEH-style solution for analyzing a suspicious executable to determine its entry point, using tools and methods suitable for a practical exam environment.

---
Scenario: Entry Point Analysis of a Suspicious Executable
You have discovered a suspicious file, die-now.exe, on a Windows machine in the directory C:\Users\Admin\Documents. As a malware analyst, your task is to identify the entry point address of this executable.

---
Step-by-Step Guide:
Step 1: Transfer the Suspicious File to a Controlled Analysis Environment
If possible, transfer die-now.exe to a sandbox or virtual environment for analysis. This can be a tool like `Remnux or Flare VM (Windows-based).`
Important: Do not execute the file on your local machine to avoid potential infection.

Step 2: Use `PEview or PE Explorer` for Initial Analysis
In a CEH exam, PEview or PE Explorer is commonly used for examining the structure of Portable Executable (PE) files.
PEview is a lightweight tool that can analyze the internal structure of the executable without executing it.
Open PEview:
1. Open PEview and navigate to C:\Users\Admin\Documents\die-now.exe.

2. Open the file in PEview to inspect its headers and sections.

Step 3: Locate the Entry Point in the Optional Header
In PEview, expand the file structure until you find the NT Headers section. Within NT Headers, locate Optional Header:
Optional Header contains the AddressOfEntryPoint, which points to the entry address in memory where the code execution begins.

Example path in PEview:
NT Headers -> Optional Header -> AddressOfEntryPoint
The AddressOfEntryPoint field will display a hexadecimal value representing the address where the program execution starts. Record this address as it is the entry point you need.

Step 4: Cross-Verify Using Other Tools (Optional)
You can use `CFF Explorer or Dependency Walker` (also commonly found in CEH labs) as a secondary method to confirm the entry point:
Open the file in CFF Explorer or Dependency Walker.
Navigate to the Optional Header in these tools, where you will also see the AddressOfEntryPoint field.

Step 5: Document the Entry Point Address
Document the entry point address from the AddressOfEntryPoint field. This is typically in a format like `0x00012345.`

---
Summary:
1. Transfer the file to a controlled environment for safe analysis.

2. Use PEview to open the file and navigate to NT Headers -> Optional Header -> AddressOfEntryPoint.

3. Note the hexadecimal value of the AddressOfEntryPoint as the entry point of the executable.

4. Cross-check the entry point with CFF Explorer or Dependency Walker if needed.

This approach follows standard CEH exam practices and avoids executing the file, ensuring a safe analysis environment. Let me know if you'd like to practice more exam-style scenarios!